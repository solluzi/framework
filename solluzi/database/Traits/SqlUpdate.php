<?php
declare(strict_types=1);
namespace Solluzi\Database\Traits;

use Solluzi\Interfaces\SQLQueryBuilder;

trait SqlUpdate
{
    /**
     * uodate function
     *  creates update query 
     * 
     * @param array $fields
     * @param array $values
     * @return SQLQueryBuilder
     */
    public function update(array $data): SQLQueryBuilder
    {
        /*
        |----------------------------------------------------------------------------------------------
        | reset
        |----------------------------------------------------------------------------------------------
        |
        | clear the query object
        |
        */
        $this->reset();
        /*
        |----------------------------------------------------------------------------------------------
        | foreach
        |----------------------------------------------------------------------------------------------
        |
        | treats the columns for update
        |
        */
        foreach (array_keys($data) as $value) {
            $columns[] = "{$value} = ?";
        }
        /*
        |----------------------------------------------------------------------------------------------
        | base
        |----------------------------------------------------------------------------------------------
        |
        | creates the query base
        |
        */
        $this->query->base = "UPDATE $this->table SET " . implode(',', $columns);
        /*
        |----------------------------------------------------------------------------------------------
        | type
        |----------------------------------------------------------------------------------------------
        |
        | set the query type
        |
        */
        $this->query->type = "update";
        /*
        |----------------------------------------------------------------------------------------------
        | values
        |----------------------------------------------------------------------------------------------
        |
        | set the values for querying
        |
        */
        $this->values = array_values($data);

        /*
        |----------------------------------------------------------------------------------------------
        | this
        |----------------------------------------------------------------------------------------------
        |
        | return object
        |
        */
        return $this;
    }
}